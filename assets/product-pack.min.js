if(0===document.querySelectorAll("component-pack").length){function resetSelectedPack(){document.querySelectorAll(".pack__wrapper .pack").forEach((t=>{t.classList.remove("pack__selected")}))}document.querySelectorAll(".pack__wrapper .pack").forEach((t=>{t.addEventListener("click",(function(){resetSelectedPack(),t.classList.add("pack__selected"),document.querySelector("input[name=quantity].quantity__input").value=t.dataset.quantity}))}))}function isStringNullish(t){return null==t||""===t}if(!customElements.get("product-pack")){class t extends HTMLElement{constructor(){super(),this.packStyle=this.dataset.style,this.sectionId=this.dataset.sectionId,this.packs=this.querySelectorAll(".pack__wrapper component-pack"),this.addToCartButton=this.querySelector("#product-pack-submit"),this.form=this.querySelector("form"),this.cart=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),this.submitButton=this.querySelector('[type="submit"]'),this.priceContainers=document.querySelectorAll(`#ProductInfo-${this.sectionId} [data-price-container]`),document.querySelector("cart-drawer")&&this.submitButton.setAttribute("aria-haspopup","dialog"),document.body.classList.add("packPresentOnPage")}connectedCallback(){this.listenEvents()}listenEvents(){this.onPackSelection();let t=[];document.addEventListener("component-pack:array-initialized",(e=>{t=e.detail.array})),this.form.addEventListener("submit",(e=>{this.addToCart(e,t)}))}resetSelectedPack(){document.querySelectorAll(".pack__wrapper .pack").forEach((t=>{t.classList.remove("pack__selected")}))}onPackSelection(){this.packs.forEach((t=>{t.addEventListener("click",(()=>{this.updatePrice(t),this.resetSelectedPack(),t.classList.add("pack__selected"),t.onPackSelection(),"stack"===this.packStyle&&this.updateSelectsDisplay(t)}))}))}updateSelectsDisplay(t){const e=document.querySelectorAll(".pack__stack--selects"),i=document.querySelectorAll(`.${t.dataset.stack}`);e.forEach((t=>t.classList.remove("stack-active"))),i.forEach((t=>t.classList.add("stack-active")))}updatePrice(t){this.priceContainers.forEach((e=>{const i=e.querySelector(".price__sale span s"),s=e.querySelector(".price-item--sale"),a=e.querySelector(".price-item");i&&s?(i.innerHTML=t.dataset.comparePrice,s.innerHTML=t.dataset.regularPrice):a.innerHTML=t.dataset.regularPrice}))}addToCart(t,e){t.preventDefault();let i=this.filterItems(e);if("true"===this.submitButton.getAttribute("aria-disabled"))return;this.submitButton.setAttribute("aria-disabled",!0),this.submitButton.classList.add("loading"),this.querySelector(".loading-overlay__spinner").classList.remove("hidden");const s=fetchConfig("javascript");s.headers["X-Requested-With"]="XMLHttpRequest",delete s.headers["Content-Type"];const a=new FormData(this.form);this.cart&&(a.append("sections",this.cart.getSectionsToRender().map((t=>t.id))),a.append("sections_url",window.location.pathname),this.cart.setActiveElement(document.activeElement)),s.body=a;for(let t=0;t<i.length;t++)s.body.set(`items[${t}][id]`,i[t].id),s.body.set(`items[${t}][quantity]`,i[t].quantity);const n=window.productATCUpsells,c=i.map((t=>t.id.toString())),r=document.querySelector("component-pack.pack__selected");let o="1";o=r?r.dataset.quantity:"1";let l=0;n&&n.length>0&&n.forEach((t=>{const e=undefined,a=t.trigger.split(",").some((t=>c.includes(t.trim())));"equals"===t.quantityBehavior?a&&t.quantity===o&&(s.body.append(`items[${l+i.length}][id]`,t.idToAdd),s.body.append(`items[${l+i.length}][quantity]`,t.quantityToAdd),l+=1):a&&t.quantity<=o&&(s.body.append(`items[${l+i.length}][id]`,t.idToAdd),s.body.append(`items[${l+i.length}][quantity]`,t.quantityToAdd),l+=1)})),0===i.length&&(s.body.set("items[product_id][id]",parseInt(this.dataset.productId)),0===document.querySelectorAll("component-pack").length?s.body.set("items[product_id][quantity]",parseInt(document.querySelector("input[name=quantity].quantity__input").value)):s.body.set("items[product_id][quantity]",parseInt(this.querySelector("component-pack.pack__selected").dataset.quantity))),fetch(`${routes.cart_add_url}`,s).then((t=>t.json())).then((t=>{if(t.status){const t=this.submitButton.querySelector(".sold-out-message");if(!t)return;return this.submitButton.setAttribute("aria-disabled",!0),this.submitButton.querySelector("span").classList.add("hidden"),t.classList.remove("hidden"),void(this.error=!0)}this.cart?this.cart.renderContents(t):window.location=window.routes.cart_url})).catch((t=>{console.error(t)})).finally((()=>{this.submitButton.classList.remove("loading"),this.cart&&this.cart.classList.contains("is-empty")&&this.cart.classList.remove("is-empty"),this.error||this.submitButton.removeAttribute("aria-disabled"),this.querySelector(".loading-overlay__spinner").classList.add("hidden")}))}filterItems(t){const e=t.reduce(((t,e)=>(null!=e.id&&(t[e.id]=(t[e.id]||0)+1),t)),{});return Object.keys(e).map((t=>({id:Number(t),quantity:e[t]})))}}customElements.define("product-pack",t)}if(!customElements.get("component-pack")){class t extends HTMLElement{constructor(){super(),this.template=this.closest("product-pack").querySelector("template#product-pack-variants").content,this.options=Array.from(this.template.querySelectorAll("option")),this.selectedVariants=[],this.trueButtonText=document.querySelector('product-pack [name="add"] .addbtntext').innerHTML}connectedCallback(){this.listenEvents(),this.initializeSelectedVariants(),this.onPackSelection()}listenEvents(){this.onOptionSelection()}initializeSelectedVariants(){0!==this.querySelectorAll(".pack__select--container").length&&(this.querySelectorAll(".pack__select--container").forEach(((t,e)=>{let i=this.options.filter((e=>e.dataset.option.split("/").map((t=>t.trim())).includes(t.querySelector("select").selectedOptions[0].value.trim())));this.selectedVariants.push({index:e,id:parseInt(i[0].dataset.id),available:"true"===i[0].dataset.available})})),this.classList.contains("pack__selected")&&this.dispatchSelectedVariants())}onPackSelection(){this.classList.contains("pack__selected")&&(this.toggleSelectedVariantsAvailability(),this.dispatchSelectedVariants())}toggleSelectedVariantsAvailability(){this.selectedVariants.some((t=>!1===t.available))?this.toggleAddButton(!0,window.variantStrings.soldOut,!1):this.toggleAddButton(!1,"",!1)}onOptionSelection(){this.querySelectorAll(".pack__select--container").forEach(((t,e)=>{this.findOptions(t,e)}))}dispatchSelectedVariants(){document.dispatchEvent(new CustomEvent("component-pack:array-initialized",{detail:{array:this.selectedVariants}}))}findOptions(t,e){t.querySelectorAll("select").forEach((i=>{i.addEventListener("change",(()=>{this.onOptionChanged(t,e),this.classList.contains("pack__selected")&&this.dispatchSelectedVariants()}))}))}onOptionChanged(t,e){let i=[];t.querySelectorAll("select").forEach((t=>{i.push(t.selectedOptions[0].value)}));let s=this.options.filter((t=>i.every((e=>t.dataset.option.split("/").map((t=>t.trim())).includes(e.trim())))));this.selectedVariant=s[0];let a=this.selectedVariants.findIndex((t=>t.index===e));-1!==a?this.selectedVariants[a]={index:e,id:parseInt(this.selectedVariant.dataset.id),available:"true"===this.selectedVariant.dataset.available}:this.selectedVariants.push({index:e,id:parseInt(this.selectedVariant.dataset.id),available:"true"===this.selectedVariant.dataset.available}),this.selectedVariant?this.toggleSelectedVariantsAvailability():console.error("Aucune variante ne correspond aux options sélectionnées.")}toggleAddButton(t=!0,e,i=!0){const s=this.closest("product-pack"),a=s.querySelector('[name="add"]'),n=s.querySelector('[name="add"] .addbtntext');a&&(t?(a.setAttribute("disabled","disabled"),e&&(n.textContent=e)):(a.removeAttribute("disabled"),n.innerHTML=this.trueButtonText))}}customElements.define("component-pack",t)}