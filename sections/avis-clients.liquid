{% comment %}
  Avis Clients Premium 3D - Version Ultra Fluide
  - 7 animations scale différentes pour desktop
  - 7 animations scale différentes pour mobile
  - Bordures personnalisables
  - Vitesse de transition réglable
  - Labels Avant/Après avec jours personnalisables
  - Couleurs modifiables pour toutes les parties
{% endcomment %}

{%- style -%}
  /* --- Import des polices calligraphiques élégantes --- */
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Dancing+Script:wght@400;600;700&display=swap');

  /* --- Définition des variables dynamiques --- */
  #shopify-section-{{ section.id }} {
    --bg-color: {{ section.settings.bg_color }};
    --card-bg-color: {{ section.settings.card_bg_color }};
    --card-border-color: {{ section.settings.card_border_color }};
    --card-active-border-color: {{ section.settings.card_active_border_color }};
    --card-border-width: {{ section.settings.card_border_width }}px;
    --title-color: {{ section.settings.title_color }};
    --text-color: {{ section.settings.text_color }};
    --verified-icon-color: {{ section.settings.verified_icon_color }};
    --star-color: {{ section.settings.star_color }};
    --star-bg-color: #00B67A;
    --star-empty-color: #dcdce6;
    --product-bg-color: {{ section.settings.product_bg_color }};
    --cta-bg-color: {{ section.settings.cta_bg_color }};
    --cta-text-color: {{ section.settings.cta_text_color }};
    --arrow-color: {{ section.settings.arrow_color | default: '#1a1a1a' }};
    --dot-color: {{ section.settings.dot_color | default: '#cccccc' }};
    --dot-active-color: {{ section.settings.dot_active_color | default: '#1a1a1a' }};
    --stat-border-color: rgba(0,0,0,0.08);
    --filter-active-color: {{ section.settings.filter_active_color | default: '#27AE60' }};
    
    --card-width-desktop: {{ section.settings.card_width_desktop }}px;
    --card-height-desktop: {{ section.settings.card_height_desktop }}px;
    --card-width-mobile: {{ section.settings.card_width_mobile }}px;
    --card-height-mobile: {{ section.settings.card_height_mobile }}px;
    
    --transition-speed: {{ section.settings.transition_speed }}s;
    
    --label-bg-color: {{ section.settings.label_bg_color }};
    --label-text-color: {{ section.settings.label_text_color }};
    --concern-badge-bg-color: {{ section.settings.concern_badge_bg_color }};
    --concern-badge-text-color: {{ section.settings.concern_badge_text_color }};
    --language-badge-bg-color: {{ section.settings.language_badge_bg_color }};
    --language-badge-text-color: {{ section.settings.language_badge_text_color }};
    --client-tag-bg-color: {{ section.settings.client_tag_bg_color }};
    --client-tag-text-color: {{ section.settings.client_tag_text_color }};
    --routine-bg-color: {{ section.settings.routine_bg_color }};
    --routine-border-color: {{ section.settings.routine_border_color }};
    --routine-title-color: {{ section.settings.routine_title_color }};
    --routine-text-color: {{ section.settings.routine_text_color }};
    
    --author-name-color: {{ section.settings.author_name_color }};
    --author-age-color: {{ section.settings.author_age_color }};
    --review-title-color: {{ section.settings.review_title_color }};
    --review-text-color: {{ section.settings.review_text_color }};
    --product-title-color: {{ section.settings.product_title_color }};
    --product-subtitle-color: {{ section.settings.product_subtitle_color }};
    --read-more-color: {{ section.settings.read_more_color }};
    --rating-number-color: {{ section.settings.rating_number_color }};
  }

  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
    background-color: var(--bg-color);
    overflow: hidden;
    font-family: 'Cormorant Garamond', Georgia, serif;
    position: relative;
  }

  .taa-container {
    max-width: {% if section.settings.layout_width == 'container' %}1200px{% else %}100%{% endif %};
    margin: 0 auto;
    padding: 0 20px;
    position: relative;
    text-align: {{ section.settings.alignment }};
  }

  /* --- Header & Badges --- */
  .taa-header-group {
    margin-bottom: 35px;
    {% if section.settings.alignment == 'center' %}
      margin-left: auto;
      margin-right: auto;
    {% endif %}
    max-width: 900px;
  }

  .taa-subheading {
    font-family: 'Playfair Display', serif;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 2.5px;
    margin-bottom: 6px;
    opacity: 0.7;
    color: var(--text-color);
    font-weight: 600;
  }

  .taa-title {
    font-family: 'Playfair Display', serif;
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 10px;
    line-height: 1.2;
    color: var(--title-color);
    letter-spacing: 0.5px;
  }

  .taa-description {
    font-family: 'Cormorant Garamond', Georgia, serif;
    font-size: 15px;
    font-style: italic;
    opacity: 0.85;
    line-height: 1.6;
    color: var(--text-color);
    margin-bottom: 16px;
  }

  /* Badges de confiance */
  .taa-trust-badges {
    display: flex;
    justify-content: {{ section.settings.alignment }};
    align-items: center;
    gap: 15px;
    margin-top: 12px;
    flex-wrap: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  .taa-trust-badges::-webkit-scrollbar { display: none; }

  .taa-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-family: 'Playfair Display', serif;
    font-size: 11px;
    font-weight: 600;
    color: var(--title-color);
    white-space: nowrap;
    background: rgba(255,255,255,0.6);
    padding: 5px 10px;
    border-radius: 20px;
    border: 1px solid rgba(0,0,0,0.06);
    flex-shrink: 0;
  }
  .taa-badge-icon { font-size: 13px; }

  /* --- FILTRES DOUBLE LIGNE --- */
  .taa-filters-wrapper {
    margin-bottom: 30px;
  }

  .taa-filters-row {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 12px;
    flex-wrap: wrap;
  }

  .taa-filters-label {
    font-family: 'Playfair Display', serif;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--text-color);
    opacity: 0.6;
    margin-bottom: 8px;
    display: block;
    text-align: center;
  }

  /* Boutons de filtre génériques */
  .taa-filter-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
    background: rgba(255,255,255,0.7);
    border: 2px solid rgba(0,0,0,0.08);
    border-radius: 25px;
    font-family: 'Playfair Display', serif;
    font-size: 12px;
    font-weight: 600;
    color: var(--text-color);
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
  }

  .taa-filter-btn:hover {
    background: white;
    border-color: rgba(0,0,0,0.15);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  }

  .taa-filter-btn.active {
    background: var(--filter-active-color);
    border-color: var(--filter-active-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
  }

  .taa-filter-icon {
    font-size: 14px;
  }

  .taa-filter-count {
    font-size: 10px;
    background: rgba(0,0,0,0.1);
    padding: 2px 6px;
    border-radius: 10px;
    margin-left: 4px;
  }

  .taa-filter-btn.active .taa-filter-count {
    background: rgba(255,255,255,0.3);
  }

  /* Séparateur entre filtres */
  .taa-filters-divider {
    width: 1px;
    height: 30px;
    background: rgba(0,0,0,0.1);
    margin: 0 5px;
  }

  /* --- Slider Container --- */
  .taa-slider-wrapper {
    display: flex;
    overflow-x: auto;
    overflow-y: visible;
    gap: 0px;
    padding: 80px calc(50% - var(--card-width-desktop) / 2) 100px;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    align-items: center;
    scrollbar-width: none;
    -ms-overflow-style: none;
    justify-content: flex-start;
    perspective: 1200px;
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
  .taa-slider-wrapper::-webkit-scrollbar { display: none; }

  /* ═══════════════════════════════════════════════════════════
     CARTES - BASE (BORDURE PERSONNALISABLE)
     ═══════════════════════════════════════════════════════════ */

  .taa-card {
    flex: 0 0 var(--card-width-desktop);
    width: var(--card-width-desktop);
    height: var(--card-height-desktop);
    margin: 0 20px;
    background: var(--card-bg-color);
    border-radius: 20px;
    display: flex;
    flex-direction: row;
    overflow: hidden;
    scroll-snap-align: center;
    position: relative;
    color: var(--text-color);
    cursor: pointer;
    z-index: 1;
    
    /* BORDURE PERSONNALISABLE */
    border: var(--card-border-width) solid var(--card-border-color);
    
    /* STABILISATION - Force le GPU et stabilise */
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    perspective: 1000px;
    will-change: transform, opacity, filter;
    transform-style: preserve-3d;
  }

  .taa-card.active {
    border-color: var(--card-active-border-color);
  }

  .taa-card.hidden {
    display: none;
  }

  /* ═══════════════════════════════════════════════════════════
     ANIMATIONS DESKTOP - 7 TYPES (VITESSE VARIABLE)
     ═══════════════════════════════════════════════════════════ */

  /* TYPE 1: Smooth Elegant - Doux et raffiné */
  .scale-desktop-smooth .taa-card {
    opacity: 0.5;
    filter: blur(2px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.8, 0.8, 1);
    transform: translate3d(0, 0, 0) scale3d(0.8, 0.8, 1);
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    -webkit-transition: all var(--transition-speed) cubic-bezier(0.25, 0.46, 0.45, 0.94);
    transition: all var(--transition-speed) cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }
  .scale-desktop-smooth .taa-card.active {
    opacity: 1;
    filter: blur(0);
    -webkit-transform: translate3d(0, 0, 0) scale3d(1.15, 1.15, 1);
    transform: translate3d(0, 0, 0) scale3d(1.15, 1.15, 1);
    box-shadow: 0 40px 80px -15px rgba(0,0,0,0.2);
    z-index: 10;
  }
  .scale-desktop-smooth .taa-card.adjacent {
    opacity: 0.65;
    filter: blur(1px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.9, 0.9, 1);
    transform: translate3d(0, 0, 0) scale3d(0.9, 0.9, 1);
  }

  /* TYPE 2: Bounce Pop - Rebond dynamique */
  .scale-desktop-bounce .taa-card {
    opacity: 0.4;
    filter: blur(3px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.7, 0.7, 1);
    transform: translate3d(0, 0, 0) scale3d(0.7, 0.7, 1);
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    -webkit-transition: all var(--transition-speed) cubic-bezier(0.68, -0.55, 0.265, 1.55);
    transition: all var(--transition-speed) cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }
  .scale-desktop-bounce .taa-card.active {
    opacity: 1;
    filter: blur(0);
    -webkit-transform: translate3d(0, 0, 0) scale3d(1.25, 1.25, 1);
    transform: translate3d(0, 0, 0) scale3d(1.25, 1.25, 1);
    box-shadow: 0 50px 100px -20px rgba(0,0,0,0.3);
    z-index: 10;
  }
  .scale-desktop-bounce .taa-card.adjacent {
    opacity: 0.55;
    filter: blur(1.5px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.85, 0.85, 1);
    transform: translate3d(0, 0, 0) scale3d(0.85, 0.85, 1);
  }

  /* TYPE 3: Elastic Stretch - Élastique fluide */
  .scale-desktop-elastic .taa-card {
    opacity: 0.45;
    filter: blur(2px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.75, 0.75, 1);
    transform: translate3d(0, 0, 0) scale3d(0.75, 0.75, 1);
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    -webkit-transition: all var(--transition-speed) cubic-bezier(0.175, 0.885, 0.32, 1.275);
    transition: all var(--transition-speed) cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
  .scale-desktop-elastic .taa-card.active {
    opacity: 1;
    filter: blur(0);
    -webkit-transform: translate3d(0, 0, 0) scale3d(1.2, 1.2, 1);
    transform: translate3d(0, 0, 0) scale3d(1.2, 1.2, 1);
    box-shadow: 0 45px 90px -15px rgba(0,0,0,0.25);
    z-index: 10;
  }
  .scale-desktop-elastic .taa-card.adjacent {
    opacity: 0.6;
    filter: blur(1px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.88, 0.88, 1);
    transform: translate3d(0, 0, 0) scale3d(0.88, 0.88, 1);
  }

  /* TYPE 4: Slow Motion - Cinématique lent */
  .scale-desktop-slow .taa-card {
    opacity: 0.5;
    filter: blur(2.5px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.78, 0.78, 1);
    transform: translate3d(0, 0, 0) scale3d(0.78, 0.78, 1);
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    -webkit-transition: all var(--transition-speed) cubic-bezier(0.22, 0.61, 0.36, 1);
    transition: all var(--transition-speed) cubic-bezier(0.22, 0.61, 0.36, 1);
  }
  .scale-desktop-slow .taa-card.active {
    opacity: 1;
    filter: blur(0);
    -webkit-transform: translate3d(0, 0, 0) scale3d(1.18, 1.18, 1);
    transform: translate3d(0, 0, 0) scale3d(1.18, 1.18, 1);
    box-shadow: 0 40px 80px -10px rgba(0,0,0,0.22);
    z-index: 10;
  }
  .scale-desktop-slow .taa-card.adjacent {
    opacity: 0.65;
    filter: blur(1px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
    transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
  }

  /* TYPE 5: Snap Quick - Rapide et précis */
  .scale-desktop-snap .taa-card {
    opacity: 0.4;
    filter: blur(2px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.82, 0.82, 1);
    transform: translate3d(0, 0, 0) scale3d(0.82, 0.82, 1);
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    -webkit-transition: all var(--transition-speed) cubic-bezier(0.34, 1.56, 0.64, 1);
    transition: all var(--transition-speed) cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  .scale-desktop-snap .taa-card.active {
    opacity: 1;
    filter: blur(0);
    -webkit-transform: translate3d(0, 0, 0) scale3d(1.22, 1.22, 1);
    transform: translate3d(0, 0, 0) scale3d(1.22, 1.22, 1);
    box-shadow: 0 45px 90px -12px rgba(0,0,0,0.28);
    z-index: 10;
  }
  .scale-desktop-snap .taa-card.adjacent {
    opacity: 0.55;
    filter: blur(1px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.9, 0.9, 1);
    transform: translate3d(0, 0, 0) scale3d(0.9, 0.9, 1);
  }

  /* TYPE 6: Fade Focus - Focus avec fondu */
  .scale-desktop-fade .taa-card {
    opacity: 0.3;
    filter: blur(4px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.85, 0.85, 1);
    transform: translate3d(0, 0, 0) scale3d(0.85, 0.85, 1);
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    -webkit-transition: all var(--transition-speed) cubic-bezier(0.4, 0, 0.2, 1);
    transition: all var(--transition-speed) cubic-bezier(0.4, 0, 0.2, 1);
  }
  .scale-desktop-fade .taa-card.active {
    opacity: 1;
    filter: blur(0);
    -webkit-transform: translate3d(0, 0, 0) scale3d(1.12, 1.12, 1);
    transform: translate3d(0, 0, 0) scale3d(1.12, 1.12, 1);
    box-shadow: 0 35px 70px -10px rgba(0,0,0,0.2);
    z-index: 10;
  }
  .scale-desktop-fade .taa-card.adjacent {
    opacity: 0.5;
    filter: blur(2px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
    transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
  }

  /* TYPE 7: Mega Zoom - Zoom extrême impressionnant */
  .scale-desktop-mega .taa-card {
    opacity: 0.35;
    filter: blur(4px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.65, 0.65, 1);
    transform: translate3d(0, 0, 0) scale3d(0.65, 0.65, 1);
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    -webkit-transition: all var(--transition-speed) cubic-bezier(0.19, 1, 0.22, 1);
    transition: all var(--transition-speed) cubic-bezier(0.19, 1, 0.22, 1);
  }
  .scale-desktop-mega .taa-card.active {
    opacity: 1;
    filter: blur(0);
    -webkit-transform: translate3d(0, 0, 0) scale3d(1.35, 1.35, 1);
    transform: translate3d(0, 0, 0) scale3d(1.35, 1.35, 1);
    box-shadow: 0 60px 120px -20px rgba(0,0,0,0.35);
    z-index: 10;
  }
  .scale-desktop-mega .taa-card.adjacent {
    opacity: 0.5;
    filter: blur(2px);
    -webkit-transform: translate3d(0, 0, 0) scale3d(0.8, 0.8, 1);
    transform: translate3d(0, 0, 0) scale3d(0.8, 0.8, 1);
  }

  /* ═══════════════════════════════════════════════════════════
     IMAGES
     ═══════════════════════════════════════════════════════════ */

  .taa-images {
    flex: 0 0 42%;
    position: relative;
    background: linear-gradient(145deg, #f8f8f8, #efefef);
    overflow: hidden;
    display: flex;
    flex-direction: row;
    height: 100%;
  }

  .taa-image-box {
    flex: 1;
    position: relative;
    height: 100%;
    overflow: hidden;
  }

  .taa-image-box::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0) 40%);
    z-index: 1;
    pointer-events: none;
  }

  .taa-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    transition: transform 0.8s ease;
  }

  .taa-card.active .taa-image {
    transform: scale(1.05);
  }

  .taa-images:not(.single-mode) .taa-image-box:first-child::before {
    content: '';
    position: absolute;
    right: 0;
    top: 10%;
    bottom: 10%;
    width: 2px;
    background: rgba(255,255,255,0.3);
    z-index: 3;
  }

  .taa-images.single-mode .taa-image-box {
    width: 100%;
    flex: 0 0 100%;
  }

  .taa-label {
    position: absolute;
    bottom: 12px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--label-bg-color);
    color: var(--label-text-color);
    text-align: center;
    padding: 6px 12px;
    font-family: 'Playfair Display', serif;
    font-size: 9px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    z-index: 2;
    border-radius: 50px;
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    white-space: nowrap;
  }

  /* Badge sur la carte (Langue + Problème) */
  .taa-card-badges {
    position: absolute;
    top: 15px;
    right: 15px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    z-index: 5;
  }

  .taa-language-badge {
    background: var(--language-badge-bg-color);
    padding: 5px 12px;
    border-radius: 14px;
    font-size: 14px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .taa-language-badge-text {
    font-family: 'Playfair Display', serif;
    font-size: 10px;
    font-weight: 600;
    color: var(--language-badge-text-color);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .taa-concern-badge {
    background: var(--concern-badge-bg-color);
    padding: 5px 12px;
    border-radius: 14px;
    font-family: 'Playfair Display', serif;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--concern-badge-text-color);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    gap: 4px;
  }

  /* ═══════════════════════════════════════════════════════════
     CONTENU
     ═══════════════════════════════════════════════════════════ */

  .taa-content {
    flex: 1;
    padding: 28px;
    text-align: left;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    background: var(--card-bg-color);
    overflow: hidden;
    box-sizing: border-box;
  }

  .taa-author-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    flex-wrap: nowrap;
    gap: 8px;
    flex-shrink: 0;
  }

  .taa-author {
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: 15px;
    color: var(--author-name-color);
    display: flex;
    align-items: center;
    gap: 6px;
    letter-spacing: 0.2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .taa-verified-icon {
    width: 16px;
    height: 16px;
    min-width: 16px;
    color: var(--verified-icon-color);
    fill: currentColor;
    flex-shrink: 0;
  }

  .taa-author-age {
    font-family: 'Cormorant Garamond', serif;
    font-size: 12px;
    font-weight: 400;
    color: var(--author-age-color);
    opacity: 0.6;
    margin-left: 4px;
    font-style: italic;
  }

  /* ═══════════════════════════════════════════════════════════
     ÉTOILES STYLE TRUSTPILOT
     ═══════════════════════════════════════════════════════════ */

  .taa-stars-wrapper {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-shrink: 0;
  }

  .taa-stars {
    display: flex;
    gap: 3px;
  }

  .taa-star-box {
    position: relative;
    width: 22px;
    height: 22px;
    min-width: 22px;
    background: var(--star-empty-color);
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
  }

  .taa-star-fill {
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    background: var(--star-bg-color);
    transition: width 0.4s ease;
  }

  .taa-star-icon {
    position: relative;
    z-index: 2;
    width: 12px;
    height: 12px;
    fill: #fff;
  }

  .taa-rating-number {
    font-family: 'Playfair Display', serif;
    font-size: 12px;
    font-weight: 700;
    color: var(--rating-number-color);
    margin-left: 4px;
    white-space: nowrap;
  }

  /* Infos client détaillées */
  .taa-client-info {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 14px;
  }

  .taa-client-tag {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    background: var(--client-tag-bg-color);
    padding: 4px 10px;
    border-radius: 12px;
    font-family: 'Cormorant Garamond', serif;
    font-size: 11px;
    color: var(--client-tag-text-color);
  }

  .taa-client-tag-icon {
    font-size: 12px;
  }

  .taa-review-title {
    font-family: 'Dancing Script', cursive;
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 10px;
    line-height: 1.2;
    color: var(--review-title-color);
    letter-spacing: 0.3px;
    flex-shrink: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  .taa-review-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: 15px;
    line-height: 1.7;
    margin-bottom: 10px;
    color: var(--review-text-color);
    flex: 1;
    overflow: hidden;
  }

  .taa-review-text.collapsed {
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Routine section */
  .taa-routine {
    background: var(--routine-bg-color);
    border-radius: 12px;
    padding: 12px 14px;
    margin-top: 10px;
    margin-bottom: 12px;
    border-left: 3px solid var(--routine-border-color);
  }

  .taa-routine-title {
    font-family: 'Playfair Display', serif;
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--routine-title-color);
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .taa-routine-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: 13px;
    line-height: 1.5;
    color: var(--routine-text-color);
    font-style: italic;
  }

  .taa-read-more {
    font-family: 'Playfair Display', serif;
    color: var(--read-more-color);
    text-decoration: underline;
    font-size: 11px;
    font-weight: 600;
    cursor: pointer;
    margin-bottom: 18px;
    display: inline-block;
    opacity: 0.8;
    transition: opacity 0.2s ease;
    flex-shrink: 0;
  }

  .taa-read-more:hover {
    opacity: 1;
  }

  /* ═══════════════════════════════════════════════════════════
     PRODUIT ASSOCIÉ
     ═══════════════════════════════════════════════════════════ */

  .taa-product {
    background: var(--product-bg-color);
    border-radius: 12px;
    padding: 10px 14px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border: none;
    transition: box-shadow 0.3s ease;
    gap: 8px;
    flex-shrink: 0;
    margin-top: auto;
  }

  .taa-product:hover {
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  }

  .taa-product-left {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
    min-width: 0;
    overflow: hidden;
  }

  .taa-product-img {
    width: 42px;
    height: 42px;
    min-width: 42px;
    border-radius: 8px;
    object-fit: cover;
    background: #fff;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    flex-shrink: 0;
  }

  .taa-product-info {
    display: flex;
    flex-direction: column;
    text-align: left;
    gap: 2px;
    min-width: 0;
    overflow: hidden;
  }

  .taa-product-title {
    font-family: 'Playfair Display', serif;
    font-size: 13px;
    font-weight: 700;
    line-height: 1.3;
    color: var(--product-title-color);
    letter-spacing: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .taa-product-subtitle {
    font-family: 'Cormorant Garamond', serif;
    font-size: 11px;
    font-weight: 500;
    opacity: 0.7;
    color: var(--product-subtitle-color);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .taa-cart-btn {
    width: 36px;
    height: 36px;
    min-width: 36px;
    background: #fff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--arrow-color);
    border: 1px solid rgba(0,0,0,0.08);
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    flex-shrink: 0;
  }

  .taa-cart-btn:hover {
    background: var(--title-color);
    color: #fff;
    border-color: var(--title-color);
    transform: scale(1.15);
    box-shadow: 0 4px 12px rgba(0,0,0,0.12);
  }

  /* ═══════════════════════════════════════════════════════════
     NAVIGATION
     ═══════════════════════════════════════════════════════════ */

  .taa-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    height: 50px;
    background: #fff;
    border-radius: 50%;
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    border: 1px solid rgba(0,0,0,0.02);
    cursor: pointer;
    z-index: 20;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--arrow-color);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  .taa-nav-btn:hover {
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 15px 35px rgba(0,0,0,0.15);
    background: var(--title-color);
    color: #fff;
  }

  .taa-nav-btn.prev { left: 10px; }
  .taa-nav-btn.next { right: 10px; }

  .taa-pagination {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 10px;
    margin-bottom: 40px;
  }

  .taa-dot {
    width: 8px;
    height: 8px;
    background: var(--dot-color);
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.4s ease;
    opacity: 0.5;
  }

  .taa-dot:hover {
    background: var(--dot-active-color);
    opacity: 0.6;
  }

  .taa-dot.active {
    background: var(--dot-active-color);
    transform: scale(1.4);
    opacity: 1;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  }

  /* Message pas de résultat */
  .taa-no-results {
    display: none;
    text-align: center;
    padding: 60px 20px;
    font-family: 'Cormorant Garamond', serif;
    font-size: 18px;
    color: var(--text-color);
    font-style: italic;
  }

  .taa-no-results.visible {
    display: block;
  }

  /* ═══════════════════════════════════════════════════════════
     STATISTIQUES
     ═══════════════════════════════════════════════════════════ */

  .taa-stats-bar {
    display: flex;
    justify-content: space-between;
    max-width: 900px;
    margin: 40px auto 0;
    padding: 25px 0;
    border-top: 1px solid var(--stat-border-color);
    border-bottom: 1px solid var(--stat-border-color);
    flex-wrap: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .taa-stats-bar::-webkit-scrollbar {
    display: none;
  }

  .taa-stat-item {
    flex: 1;
    text-align: center;
    padding: 0 15px;
    border-right: 1px solid var(--stat-border-color);
    min-width: auto;
    flex-shrink: 0;
  }

  .taa-stat-item:last-child {
    border-right: none;
  }

  .taa-stat-number {
    display: block;
    font-family: 'Playfair Display', serif;
    font-size: clamp(22px, 4vw, 26px);
    font-weight: 700;
    color: var(--title-color);
    margin-bottom: 4px;
    line-height: 1.1;
    letter-spacing: -0.02em;
    white-space: nowrap;
  }

  .taa-stat-label {
    font-family: 'Cormorant Garamond', serif;
    font-size: 12px;
    color: var(--text-color);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-style: italic;
    white-space: nowrap;
  }

  /* ═══════════════════════════════════════════════════════════
     ANIMATIONS CONTENU (si activées)
     ═══════════════════════════════════════════════════════════ */

  {% if section.settings.enable_animations %}
  /* Animation contenu carte */
  .taa-card .taa-content > * {
    opacity: 0;
    transform: translateY(15px);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .taa-card.in-view .taa-content > * {
    opacity: 1;
    transform: translateY(0);
  }

  .taa-card.in-view .taa-author-row { transition-delay: 0.1s; }
  .taa-card.in-view .taa-client-info { transition-delay: 0.15s; }
  .taa-card.in-view .taa-review-title { transition-delay: 0.2s; }
  .taa-card.in-view .taa-review-text { transition-delay: 0.25s; }
  .taa-card.in-view .taa-routine { transition-delay: 0.3s; }
  .taa-card.in-view .taa-read-more { transition-delay: 0.35s; }
  .taa-card.in-view .taa-product { transition-delay: 0.4s; }

  /* Animation étoiles Trustpilot */
  .taa-star-box {
    opacity: 0;
    transform: scale(0) rotate(-20deg);
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .taa-card.in-view .taa-star-box {
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }

  .taa-card.in-view .taa-star-box:nth-child(1) { transition-delay: 0.15s; }
  .taa-card.in-view .taa-star-box:nth-child(2) { transition-delay: 0.2s; }
  .taa-card.in-view .taa-star-box:nth-child(3) { transition-delay: 0.25s; }
  .taa-card.in-view .taa-star-box:nth-child(4) { transition-delay: 0.3s; }
  .taa-card.in-view .taa-star-box:nth-child(5) { transition-delay: 0.35s; }

  .taa-star-fill {
    transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    transition-delay: 0.5s;
  }
  {% endif %}

  /* ═══════════════════════════════════════════════════════════
     RESPONSIVE MOBILE - 7 TYPES D'ANIMATIONS (VITESSE VARIABLE)
     ═══════════════════════════════════════════════════════════ */

  @media screen and (max-width: 768px) {
    .taa-header-group {
      margin-bottom: 25px;
      text-align: center;
    }

    .taa-subheading {
      font-size: 10px;
      letter-spacing: 2px;
    }

    .taa-title {
      font-size: 24px;
    }

    .taa-description {
      font-size: 14px;
    }

    .taa-trust-badges {
      justify-content: flex-start;
      gap: 10px;
      padding: 0 10px;
    }

    .taa-badge {
      font-size: 10px;
      padding: 4px 8px;
      gap: 4px;
    }

    .taa-badge-icon {
      font-size: 12px;
    }

    .taa-filters-row {
      gap: 8px;
      overflow-x: auto;
      flex-wrap: nowrap;
      justify-content: flex-start;
      padding: 0 10px;
      -webkit-overflow-scrolling: touch;
    }

    .taa-filter-btn {
      padding: 6px 12px;
      font-size: 11px;
      flex-shrink: 0;
    }

    .taa-filters-divider {
      display: none;
    }

    .taa-slider-wrapper {
      gap: 0;
      padding: 60px calc(50% - var(--card-width-mobile) / 2) 70px;
    }

    /* BASE MOBILE - Cartes verticales */
    .taa-card {
      flex: 0 0 var(--card-width-mobile);
      width: var(--card-width-mobile);
      height: auto;
      min-height: var(--card-height-mobile);
      flex-direction: column;
      margin: 0 15px;
      border-radius: 18px;
    }

    /* ═══════════════════════════════════════════════════════════
       ANIMATIONS MOBILE - 7 TYPES (VITESSE VARIABLE)
       ═══════════════════════════════════════════════════════════ */

    /* TYPE 1: Smooth Elegant Mobile */
    .scale-mobile-smooth .taa-card {
      opacity: 0.5;
      filter: blur(2px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.85, 0.85, 1);
      transform: translate3d(0, 0, 0) scale3d(0.85, 0.85, 1);
      -webkit-transition: all var(--transition-speed) cubic-bezier(0.25, 0.46, 0.45, 0.94);
      transition: all var(--transition-speed) cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    .scale-mobile-smooth .taa-card.active {
      opacity: 1;
      filter: blur(0);
      -webkit-transform: translate3d(0, 0, 0) scale3d(1.08, 1.08, 1);
      transform: translate3d(0, 0, 0) scale3d(1.08, 1.08, 1);
      box-shadow: 0 30px 60px -10px rgba(0,0,0,0.2);
      z-index: 10;
    }
    .scale-mobile-smooth .taa-card.adjacent {
      opacity: 0.65;
      filter: blur(1px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
      transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
    }

    /* TYPE 2: Bounce Pop Mobile */
    .scale-mobile-bounce .taa-card {
      opacity: 0.45;
      filter: blur(2.5px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.78, 0.78, 1);
      transform: translate3d(0, 0, 0) scale3d(0.78, 0.78, 1);
      -webkit-transition: all var(--transition-speed) cubic-bezier(0.68, -0.55, 0.265, 1.55);
      transition: all var(--transition-speed) cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    .scale-mobile-bounce .taa-card.active {
      opacity: 1;
      filter: blur(0);
      -webkit-transform: translate3d(0, 0, 0) scale3d(1.15, 1.15, 1);
      transform: translate3d(0, 0, 0) scale3d(1.15, 1.15, 1);
      box-shadow: 0 40px 80px -15px rgba(0,0,0,0.28);
      z-index: 10;
    }
    .scale-mobile-bounce .taa-card.adjacent {
      opacity: 0.55;
      filter: blur(1.5px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.88, 0.88, 1);
      transform: translate3d(0, 0, 0) scale3d(0.88, 0.88, 1);
    }

    /* TYPE 3: Elastic Stretch Mobile */
    .scale-mobile-elastic .taa-card {
      opacity: 0.5;
      filter: blur(2px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.8, 0.8, 1);
      transform: translate3d(0, 0, 0) scale3d(0.8, 0.8, 1);
      -webkit-transition: all var(--transition-speed) cubic-bezier(0.175, 0.885, 0.32, 1.275);
      transition: all var(--transition-speed) cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .scale-mobile-elastic .taa-card.active {
      opacity: 1;
      filter: blur(0);
      -webkit-transform: translate3d(0, 0, 0) scale3d(1.12, 1.12, 1);
      transform: translate3d(0, 0, 0) scale3d(1.12, 1.12, 1);
      box-shadow: 0 35px 70px -12px rgba(0,0,0,0.25);
      z-index: 10;
    }
    .scale-mobile-elastic .taa-card.adjacent {
      opacity: 0.6;
      filter: blur(1px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.9, 0.9, 1);
      transform: translate3d(0, 0, 0) scale3d(0.9, 0.9, 1);
    }

    /* TYPE 4: Slow Motion Mobile */
    .scale-mobile-slow .taa-card {
      opacity: 0.5;
      filter: blur(2px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.82, 0.82, 1);
      transform: translate3d(0, 0, 0) scale3d(0.82, 0.82, 1);
      -webkit-transition: all var(--transition-speed) cubic-bezier(0.22, 0.61, 0.36, 1);
      transition: all var(--transition-speed) cubic-bezier(0.22, 0.61, 0.36, 1);
    }
    .scale-mobile-slow .taa-card.active {
      opacity: 1;
      filter: blur(0);
      -webkit-transform: translate3d(0, 0, 0) scale3d(1.1, 1.1, 1);
      transform: translate3d(0, 0, 0) scale3d(1.1, 1.1, 1);
      box-shadow: 0 30px 60px -10px rgba(0,0,0,0.2);
      z-index: 10;
    }
    .scale-mobile-slow .taa-card.adjacent {
      opacity: 0.65;
      filter: blur(1px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
      transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
    }

    /* TYPE 5: Snap Quick Mobile */
    .scale-mobile-snap .taa-card {
      opacity: 0.45;
      filter: blur(2px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.84, 0.84, 1);
      transform: translate3d(0, 0, 0) scale3d(0.84, 0.84, 1);
      -webkit-transition: all var(--transition-speed) cubic-bezier(0.34, 1.56, 0.64, 1);
      transition: all var(--transition-speed) cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .scale-mobile-snap .taa-card.active {
      opacity: 1;
      filter: blur(0);
      -webkit-transform: translate3d(0, 0, 0) scale3d(1.12, 1.12, 1);
      transform: translate3d(0, 0, 0) scale3d(1.12, 1.12, 1);
      box-shadow: 0 35px 70px -10px rgba(0,0,0,0.25);
      z-index: 10;
    }
    .scale-mobile-snap .taa-card.adjacent {
      opacity: 0.55;
      filter: blur(1px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
      transform: translate3d(0, 0, 0) scale3d(0.92, 0.92, 1);
    }

    /* TYPE 6: Fade Focus Mobile */
    .scale-mobile-fade .taa-card {
      opacity: 0.35;
      filter: blur(3px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.88, 0.88, 1);
      transform: translate3d(0, 0, 0) scale3d(0.88, 0.88, 1);
      -webkit-transition: all var(--transition-speed) cubic-bezier(0.4, 0, 0.2, 1);
      transition: all var(--transition-speed) cubic-bezier(0.4, 0, 0.2, 1);
    }
    .scale-mobile-fade .taa-card.active {
      opacity: 1;
      filter: blur(0);
      -webkit-transform: translate3d(0, 0, 0) scale3d(1.06, 1.06, 1);
      transform: translate3d(0, 0, 0) scale3d(1.06, 1.06, 1);
      box-shadow: 0 28px 56px -8px rgba(0,0,0,0.2);
      z-index: 10;
    }
    .scale-mobile-fade .taa-card.adjacent {
      opacity: 0.5;
      filter: blur(2px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.94, 0.94, 1);
      transform: translate3d(0, 0, 0) scale3d(0.94, 0.94, 1);
    }

    /* TYPE 7: Mega Zoom Mobile */
    .scale-mobile-mega .taa-card {
      opacity: 0.4;
      filter: blur(3px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.72, 0.72, 1);
      transform: translate3d(0, 0, 0) scale3d(0.72, 0.72, 1);
      -webkit-transition: all var(--transition-speed) cubic-bezier(0.19, 1, 0.22, 1);
      transition: all var(--transition-speed) cubic-bezier(0.19, 1, 0.22, 1);
    }
    .scale-mobile-mega .taa-card.active {
      opacity: 1;
      filter: blur(0);
      -webkit-transform: translate3d(0, 0, 0) scale3d(1.2, 1.2, 1);
      transform: translate3d(0, 0, 0) scale3d(1.2, 1.2, 1);
      box-shadow: 0 45px 90px -15px rgba(0,0,0,0.3);
      z-index: 10;
    }
    .scale-mobile-mega .taa-card.adjacent {
      opacity: 0.5;
      filter: blur(2px);
      -webkit-transform: translate3d(0, 0, 0) scale3d(0.85, 0.85, 1);
      transform: translate3d(0, 0, 0) scale3d(0.85, 0.85, 1);
    }

    .taa-images {
      flex: 0 0 200px;
      width: 100%;
      height: 200px;
    }

    .taa-image-box {
      min-height: 200px;
    }

    .taa-content {
      flex: 1;
      width: 100%;
      padding: 20px 15px;
    }

    .taa-label {
      padding: 5px 10px;
      font-size: 8px;
      bottom: 8px;
    }

    .taa-nav-btn {
      display: none;
    }

    .taa-review-title {
      font-size: 20px;
    }

    .taa-review-text {
      font-size: 14px;
      -webkit-line-clamp: 4;
    }

    .taa-author {
      font-size: 13px;
    }

    .taa-client-info {
      gap: 6px;
    }

    .taa-client-tag {
      font-size: 10px;
      padding: 3px 8px;
    }

    .taa-star-box {
      width: 18px;
      height: 18px;
      min-width: 18px;
    }

    .taa-star-icon {
      width: 10px;
      height: 10px;
    }

    .taa-rating-number {
      font-size: 10px;
    }

    .taa-stats-bar {
      flex-direction: column;
      gap: 20px;
      padding: 20px 0;
    }

    .taa-stat-item {
      border-right: none;
      border-bottom: 1px solid var(--stat-border-color);
      padding-bottom: 15px;
    }

    .taa-stat-item:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    .taa-stat-number {
      font-size: 22px;
    }

    .taa-stat-label {
      font-size: 10px;
      letter-spacing: 0.5px;
    }
  }
{%- endstyle -%}

<div id="{{ section.settings.section_id }}" class="section-{{ section.id }}-padding scale-desktop-{{ section.settings.scale_type_desktop }} scale-mobile-{{ section.settings.scale_type_mobile }}">

  <div class="taa-container">

    <!-- En-tête -->
    <div class="taa-header-group">
      {% if section.settings.subheading != blank %}
        <div class="taa-subheading">{{ section.settings.subheading }}</div>
      {% endif %}
      {% if section.settings.title != blank %}
        <h2 class="taa-title">{{ section.settings.title | escape }}</h2>
      {% endif %}
      {% if section.settings.description != blank %}
        <div class="taa-description">{{ section.settings.description }}</div>
      {% endif %}

      <!-- Badges de Confiance -->
      <div class="taa-trust-badges">
        <div class="taa-badge">
          <span class="taa-badge-icon">{{ section.settings.badge_1_icon }}</span>
          <span>{{ section.settings.badge_1_text }}</span>
        </div>
        <div class="taa-badge">
          <span class="taa-badge-icon">{{ section.settings.badge_2_icon }}</span>
          <span>{{ section.settings.badge_2_text }}</span>
        </div>
        <div class="taa-badge">
          <span class="taa-badge-icon">{{ section.settings.badge_3_icon }}</span>
          <span>{{ section.settings.badge_3_text }}</span>
        </div>
      </div>
    </div>

    <!-- FILTRES DOUBLE LIGNE -->
    <div class="taa-filters-wrapper">

      <!-- Ligne 1: Filtres par problème de peau -->
      {% if section.settings.show_concern_filter %}
      <span class="taa-filters-label">{{ section.settings.filter_concern_label }}</span>
      <div class="taa-filters-row" id="ConcernFilters-{{ section.id }}">
        <button class="taa-filter-btn active" data-concern="all">
          <span class="taa-filter-icon">{{ section.settings.filter_all_icon }}</span>
          <span>{{ section.settings.filter_all_text }}</span>
        </button>
        <button class="taa-filter-btn" data-concern="boutons">
          <span class="taa-filter-icon">{{ section.settings.filter_boutons_icon }}</span>
          <span>{{ section.settings.filter_boutons_text }}</span>
        </button>
        <button class="taa-filter-btn" data-concern="rides">
          <span class="taa-filter-icon">{{ section.settings.filter_rides_icon }}</span>
          <span>{{ section.settings.filter_rides_text }}</span>
        </button>
        <button class="taa-filter-btn" data-concern="rougeurs">
          <span class="taa-filter-icon">{{ section.settings.filter_rougeurs_icon }}</span>
          <span>{{ section.settings.filter_rougeurs_text }}</span>
        </button>
      </div>
      {% endif %}

      <!-- Ligne 2: Filtres par langue -->
      {% if section.settings.show_language_filter %}
      <div class="taa-filters-row" id="LangFilters-{{ section.id }}" style="margin-top: 15px;">
        <button class="taa-filter-btn active" data-lang="all">
          <span class="taa-filter-icon">{{ section.settings.filter_lang_all_icon }}</span>
          <span>{{ section.settings.filter_lang_all_text }}</span>
        </button>
        <button class="taa-filter-btn" data-lang="fr">
          <span class="taa-filter-icon">{{ section.settings.filter_lang_fr_icon }}</span>
          <span>{{ section.settings.filter_lang_fr_text }}</span>
        </button>
        <button class="taa-filter-btn" data-lang="ca">
          <span class="taa-filter-icon">{{ section.settings.filter_lang_ca_icon }}</span>
          <span>{{ section.settings.filter_lang_ca_text }}</span>
        </button>
        <button class="taa-filter-btn" data-lang="be">
          <span class="taa-filter-icon">{{ section.settings.filter_lang_be_icon }}</span>
          <span>{{ section.settings.filter_lang_be_text }}</span>
        </button>
      </div>
      {% endif %}

    </div>

    <!-- Message pas de résultat -->
    <div class="taa-no-results" id="NoResults-{{ section.id }}">
      {{ section.settings.no_results_text }}
    </div>

    <!-- Slider Zone -->
    <div style="position:relative;">
      {% if section.settings.show_navigation %}
        <button class="taa-nav-btn prev" aria-label="{{ section.settings.nav_prev_label }}"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg></button>
        <button class="taa-nav-btn next" aria-label="{{ section.settings.nav_next_label }}"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg></button>
      {% endif %}

      <div class="taa-slider-wrapper" id="Slider-{{ section.id }}"
           data-autoplay="{{ section.settings.enable_autoplay }}"
           data-delay="{{ section.settings.autoplay_delay | times: 1000 }}">
        {% for block in section.blocks %}
          {% assign rating_value = block.settings.rating %}
          {% assign rating_floor = rating_value | floor %}
          {% assign rating_next = rating_floor | plus: 1 %}
          {% assign rating_decimal = rating_value | minus: rating_floor | times: 100 | round %}

          <div class="taa-card {% if forloop.first %}active in-view{% endif %}"
               data-language="{{ block.settings.review_language }}"
               data-concern="{{ block.settings.skin_concern }}"
               style="--card-index: {{ forloop.index0 }}"
               {{ block.shopify_attributes }}>

            <!-- Badges sur la carte -->
            <div class="taa-card-badges">
              {% if block.settings.show_country_flag %}
                <div class="taa-language-badge">
                  <span>{{ block.settings.country_flag }}</span>
                  {% if block.settings.show_language_code %}
                    <span class="taa-language-badge-text">{{ block.settings.review_language }}</span>
                  {% endif %}
                </div>
              {% endif %}

              {% if block.settings.skin_concern != blank and block.settings.skin_concern != 'none' %}
                <div class="taa-concern-badge">
                  {% case block.settings.skin_concern %}
                    {% when 'boutons' %}{{ section.settings.badge_boutons_icon }} {{ section.settings.badge_boutons_text }}
                    {% when 'rides' %}{{ section.settings.badge_rides_icon }} {{ section.settings.badge_rides_text }}
                    {% when 'rougeurs' %}{{ section.settings.badge_rougeurs_icon }} {{ section.settings.badge_rougeurs_text }}
                  {% endcase %}
                </div>
              {% endif %}
            </div>

            <!-- Zone Images -->
            <div class="taa-images {% if block.settings.use_single_image %}single-mode{% endif %}">
              {% if block.settings.use_single_image %}
                <div class="taa-image-box">
                  {% if block.settings.image_combined != blank %}
                    <img src="{{ block.settings.image_combined | img_url: '800x' }}" class="taa-image" loading="lazy" alt="Résultat">
                  {% else %}
                    {{ 'image' | placeholder_svg_tag: 'taa-image' }}
                  {% endif %}
                </div>
              {% else %}
                <div class="taa-image-box">
                  {% if block.settings.image_before != blank %}
                    <img src="{{ block.settings.image_before | img_url: '600x' }}" class="taa-image" loading="lazy" alt="Avant">
                  {% else %}
                    {{ 'image' | placeholder_svg_tag: 'taa-image' }}
                  {% endif %}
                  <div class="taa-label">
                    {% if block.settings.label_before_custom != blank %}
                      {{ block.settings.label_before_custom }}
                    {% else %}
                      {{ section.settings.label_before_text }}
                    {% endif %}
                  </div>
                </div>
                <div class="taa-image-box">
                  {% if block.settings.image_after != blank %}
                    <img src="{{ block.settings.image_after | img_url: '600x' }}" class="taa-image" loading="lazy" alt="Après">
                  {% else %}
                    {{ 'image' | placeholder_svg_tag: 'taa-image' }}
                  {% endif %}
                  <div class="taa-label">
                    {% if block.settings.label_after_custom != blank %}
                      {{ block.settings.label_after_custom }}
                    {% else %}
                      {{ section.settings.label_after_text }}
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            </div>

            <!-- Zone Contenu -->
            <div class="taa-content">
              <div class="taa-author-row">
                <div class="taa-author">
                  {{ block.settings.author_name }}
                  <svg class="taa-verified-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                  {% if block.settings.author_age != blank %}
                    <span class="taa-author-age">({{ block.settings.author_age }})</span>
                  {% endif %}
                </div>

                <!-- Étoiles Trustpilot avec remplissage partiel -->
                <div class="taa-stars-wrapper">
                  <div class="taa-stars">
                    {%- for i in (1..5) -%}
                      {% if i <= rating_floor %}
                        {% assign fill_percent = 100 %}
                      {% elsif i == rating_next %}
                        {% assign fill_percent = rating_decimal %}
                      {% else %}
                        {% assign fill_percent = 0 %}
                      {% endif %}

                      <div class="taa-star-box">
                        <div class="taa-star-fill" style="width: {{ fill_percent }}%;"></div>
                        <svg class="taa-star-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                          <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                        </svg>
                      </div>
                    {%- endfor -%}
                  </div>
                  <span class="taa-rating-number">{{ block.settings.rating }}/5</span>
                </div>
              </div>

              <!-- Tags Client (Type de peau, durée utilisation, etc.) -->
              <div class="taa-client-info">
                {% if block.settings.skin_type != blank %}
                  <span class="taa-client-tag">
                    <span class="taa-client-tag-icon">{{ section.settings.tag_skin_type_icon }}</span>
                    {{ block.settings.skin_type }}
                  </span>
                {% endif %}
                {% if block.settings.usage_duration != blank %}
                  <span class="taa-client-tag">
                    <span class="taa-client-tag-icon">{{ section.settings.tag_duration_icon }}</span>
                    {{ block.settings.usage_duration }}
                  </span>
                {% endif %}
                {% if block.settings.skin_concern != blank and block.settings.skin_concern != 'none' %}
                  <span class="taa-client-tag">
                    <span class="taa-client-tag-icon">{{ section.settings.tag_concern_icon }}</span>
                    {% case block.settings.skin_concern %}
                      {% when 'boutons' %}{{ section.settings.tag_boutons_text }}
                      {% when 'rides' %}{{ section.settings.tag_rides_text }}
                      {% when 'rougeurs' %}{{ section.settings.tag_rougeurs_text }}
                    {% endcase %}
                  </span>
                {% endif %}
              </div>

              <h3 class="taa-review-title">{{ block.settings.review_title }}</h3>

              <div class="taa-review-text collapsed" id="Review-{{ block.id }}">
                {{ block.settings.review_text }}
              </div>

              <!-- Section Routine -->
              {% if block.settings.routine_text != blank %}
                <div class="taa-routine">
                  <div class="taa-routine-title">
                    <span>{{ section.settings.routine_icon }}</span> {{ section.settings.routine_title_text }}
                  </div>
                  <div class="taa-routine-text">
                    {{ block.settings.routine_text }}
                  </div>
                </div>
              {% endif %}

              <span class="taa-read-more" onclick="toggleReadMore('{{ block.id }}', '{{ section.settings.read_more_label }}', '{{ section.settings.read_less_label }}')">
                {{ section.settings.read_more_label }}
              </span>

              <!-- Bloc Produit -->
              <div class="taa-product">
                {% if block.settings.product != blank %}
                  {% assign product = all_products[block.settings.product] %}
                  <div class="taa-product-left">
                    <img src="{{ product.featured_image | img_url: '100x' }}" class="taa-product-img" alt="{{ product.title }}">
                    <div class="taa-product-info">
                      <span class="taa-product-title">{{ product.title | truncate: 25 }}</span>
                      <span class="taa-product-subtitle">{{ product.price | money }}</span>
                    </div>
                  </div>
                  <a href="{{ product.url }}" class="taa-cart-btn" aria-label="{{ section.settings.cart_btn_label }}">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line></svg>
                  </a>
                {% else %}
                  <div class="taa-product-left">
                    {{ 'product-1' | placeholder_svg_tag: 'taa-product-img' }}
                    <div class="taa-product-info">
                      <span class="taa-product-title">{{ section.settings.product_placeholder_title }}</span>
                      <span class="taa-product-subtitle">{{ section.settings.product_placeholder_price }}</span>
                    </div>
                  </div>
                  <button class="taa-cart-btn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line></svg></button>
                {% endif %}
              </div>

            </div>
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- Pagination Dots -->
    {% if section.settings.show_pagination %}
      <div class="taa-pagination">
        {% for block in section.blocks %}
          <div class="taa-dot {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}"></div>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Barre de Statistiques -->
    <div class="taa-stats-bar">
      <div class="taa-stat-item">
        <span class="taa-stat-number">{{ section.settings.stat_1_number }}</span>
        <span class="taa-stat-label">{{ section.settings.stat_1_label }}</span>
      </div>
      <div class="taa-stat-item">
        <span class="taa-stat-number">{{ section.settings.stat_2_number }}</span>
        <span class="taa-stat-label">{{ section.settings.stat_2_label }}</span>
      </div>
      <div class="taa-stat-item">
        <span class="taa-stat-number">{{ section.settings.stat_3_number }}</span>
        <span class="taa-stat-label">{{ section.settings.stat_3_label }}</span>
      </div>
    </div>

  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const slider = document.getElementById('Slider-{{ section.id }}');
  if(!slider) return;

  const cards = slider.querySelectorAll('.taa-card');
  const dots = document.querySelectorAll('.taa-dot');
  const prevBtn = slider.parentElement.querySelector('.prev');
  const nextBtn = slider.parentElement.querySelector('.next');
  const concernButtons = document.querySelectorAll('#ConcernFilters-{{ section.id }} .taa-filter-btn');
  const langButtons = document.querySelectorAll('#LangFilters-{{ section.id }} .taa-filter-btn');
  const noResultsMsg = document.getElementById('NoResults-{{ section.id }}');
  const enableActiveCard = {{ section.settings.enable_active_card | default: true }};

  let activeConcern = 'all';
  let activeLang = 'all';
  let isScrolling = false;
  let lastActiveIndex = 0;

  // Fonction Voir Plus / Voir Moins
  window.toggleReadMore = function(id, moreLabel, lessLabel) {
    const textDiv = document.getElementById('Review-' + id);
    const btn = event.target;
    if(textDiv.classList.contains('collapsed')) {
      textDiv.classList.remove('collapsed');
      btn.innerText = lessLabel;
    } else {
      textDiv.classList.add('collapsed');
      btn.innerText = moreLabel;
    }
  };

  // Fonction de filtrage combinée (concern + langue)
  function applyFilters() {
    let visibleCount = 0;

    cards.forEach(function(card) {
      const cardLang = card.dataset.language;
      const cardConcern = card.dataset.concern;

      const matchLang = (activeLang === 'all' || cardLang === activeLang);
      const matchConcern = (activeConcern === 'all' || cardConcern === activeConcern);

      if (matchLang && matchConcern) {
        card.classList.remove('hidden');
        visibleCount++;
      } else {
        card.classList.add('hidden');
      }
    });

    // Afficher/masquer message "pas de résultat"
    if (visibleCount === 0) {
      noResultsMsg.classList.add('visible');
      slider.style.display = 'none';
    } else {
      noResultsMsg.classList.remove('visible');
      slider.style.display = 'flex';

      // Reset to first visible card
      setTimeout(function() {
        const firstVisible = slider.querySelector('.taa-card:not(.hidden)');
        if(firstVisible) {
          if(enableActiveCard) {
            cards.forEach(function(c) { c.classList.remove('active', 'adjacent'); });
            firstVisible.classList.add('active');
          }
          firstVisible.classList.add('in-view');
          firstVisible.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
        }
      }, 100);
    }
  }

  // Event listeners pour filtres problème
  concernButtons.forEach(function(btn) {
    btn.addEventListener('click', function() {
      activeConcern = btn.dataset.concern;
      concernButtons.forEach(function(b) { b.classList.remove('active'); });
      btn.classList.add('active');
      applyFilters();
    });
  });

  // Event listeners pour filtres langue
  langButtons.forEach(function(btn) {
    btn.addEventListener('click', function() {
      activeLang = btn.dataset.lang;
      langButtons.forEach(function(b) { b.classList.remove('active'); });
      btn.classList.add('active');
      applyFilters();
    });
  });

  // Scroll au click sur une carte
  cards.forEach(function(card) {
    card.addEventListener('click', function() {
      if(card.classList.contains('hidden')) return;
      const cardCenter = card.offsetLeft + (card.offsetWidth / 2);
      const sliderCenter = slider.offsetWidth / 2;
      slider.scrollTo({ left: cardCenter - sliderCenter, behavior: 'smooth' });
    });
  });

  // Mise à jour de la carte active et in-view (STABILISÉE)
  function updateActive() {
    const center = slider.scrollLeft + (slider.offsetWidth / 2);
    let closest = null;
    let minDist = Infinity;
    let activeIndex = 0;

    cards.forEach(function(card, i) {
      if(card.classList.contains('hidden')) return;

      const cardLeft = card.offsetLeft;
      const cardRight = cardLeft + card.offsetWidth;
      const cardCenter = cardLeft + card.offsetWidth / 2;
      const dist = Math.abs(cardCenter - center);

      // Check if card is in view for animations
      const sliderLeft = slider.scrollLeft;
      const sliderRight = sliderLeft + slider.offsetWidth;

      if (cardRight > sliderLeft && cardLeft < sliderRight) {
        card.classList.add('in-view');
      } else {
        card.classList.remove('in-view');
      }

      if(dist < minDist) {
        minDist = dist;
        closest = card;
        activeIndex = i;
      }
    });

    // Éviter les mises à jour inutiles
    if (activeIndex === lastActiveIndex && slider.querySelector('.taa-card.active')) {
      return;
    }
    lastActiveIndex = activeIndex;

    if(enableActiveCard) {
      cards.forEach(function(c) { c.classList.remove('active', 'adjacent'); });
      if(closest) closest.classList.add('active');

      // Marquer les cartes adjacentes
      if(activeIndex > 0 && !cards[activeIndex - 1].classList.contains('hidden')) {
        cards[activeIndex - 1].classList.add('adjacent');
      }
      if(activeIndex < cards.length - 1 && !cards[activeIndex + 1].classList.contains('hidden')) {
        cards[activeIndex + 1].classList.add('adjacent');
      }
    }

    dots.forEach(function(d) { d.classList.remove('active'); });
    if(dots[activeIndex]) dots[activeIndex].classList.add('active');
  }

  // Scroll avec requestAnimationFrame pour fluidité
  slider.addEventListener('scroll', function() {
    if (!isScrolling) {
      window.requestAnimationFrame(function() {
        updateActive();
        isScrolling = false;
      });
      isScrolling = true;
    }
  }, { passive: true });

  // Initialisation
  setTimeout(updateActive, 100);

  // Navigation flèches
  if(prevBtn) {
    prevBtn.addEventListener('click', function() {
      const visibleCards = Array.from(cards).filter(function(c) { return !c.classList.contains('hidden'); });
      const activeIndex = visibleCards.findIndex(function(c) { return c.classList.contains('active'); });
      const targetIndex = activeIndex > 0 ? activeIndex - 1 : visibleCards.length - 1;
      visibleCards[targetIndex].click();
    });
  }
  if(nextBtn) {
    nextBtn.addEventListener('click', function() {
      const visibleCards = Array.from(cards).filter(function(c) { return !c.classList.contains('hidden'); });
      const activeIndex = visibleCards.findIndex(function(c) { return c.classList.contains('active'); });
      const targetIndex = activeIndex < visibleCards.length - 1 ? activeIndex + 1 : 0;
      visibleCards[targetIndex].click();
    });
  }

  // Pagination points
  dots.forEach(function(dot, i) {
    dot.addEventListener('click', function() {
      if(!cards[i].classList.contains('hidden')) {
        cards[i].click();
      }
    });
  });

  // Autoplay
  const autoplay = slider.dataset.autoplay === 'true';
  const delay = parseInt(slider.dataset.delay) || 5000;
  if(autoplay) {
    setInterval(function() {
      if(!slider.matches(':hover')) {
        const visibleCards = Array.from(cards).filter(function(c) { return !c.classList.contains('hidden'); });
        const activeIndex = visibleCards.findIndex(function(c) { return c.classList.contains('active'); });
        const targetIndex = activeIndex < visibleCards.length - 1 ? activeIndex + 1 : 0;
        visibleCards[targetIndex].click();
      }
    }, delay);
  }
});
</script>

{% schema %}
{
  "name": "Avis Clients Premium 3D",
  "settings": [
    { "type": "header", "content": "═══ TEXTES PRINCIPAUX ═══" },
    { "type": "text", "id": "section_id", "label": "ID de section" },
    { "type": "text", "id": "subheading", "label": "Sous-titre", "default": "TÉMOIGNAGES VÉRIFIÉS" },
    { "type": "text", "id": "title", "label": "Titre Principal", "default": "Résultats prouvés par notre communauté" },
    { "type": "textarea", "id": "description", "label": "Description", "default": "Découvrez les transformations réelles de femmes qui ont retrouvé confiance en leur peau." },
    { "type": "select", "id": "alignment", "label": "Alignement", "options": [ { "value": "left", "label": "Gauche" }, { "value": "center", "label": "Centrer" } ], "default": "center" },

    { "type": "header", "content": "═══ ANIMATIONS SCALE ═══" },
    {
      "type": "select",
      "id": "scale_type_desktop",
      "label": "Animation Desktop",
      "options": [
        { "value": "smooth", "label": "1. Smooth Elegant - Doux et raffiné" },
        { "value": "bounce", "label": "2. Bounce Pop - Rebond dynamique" },
        { "value": "elastic", "label": "3. Elastic Stretch - Élastique fluide" },
        { "value": "slow", "label": "4. Slow Motion - Cinématique lent" },
        { "value": "snap", "label": "5. Snap Quick - Rapide et précis" },
        { "value": "fade", "label": "6. Fade Focus - Focus avec fondu" },
        { "value": "mega", "label": "7. Mega Zoom - Zoom extrême" }
      ],
      "default": "smooth"
    },
    {
      "type": "select",
      "id": "scale_type_mobile",
      "label": "Animation Mobile",
      "options": [
        { "value": "smooth", "label": "1. Smooth Elegant - Doux et raffiné" },
        { "value": "bounce", "label": "2. Bounce Pop - Rebond dynamique" },
        { "value": "elastic", "label": "3. Elastic Stretch - Élastique fluide" },
        { "value": "slow", "label": "4. Slow Motion - Cinématique lent" },
        { "value": "snap", "label": "5. Snap Quick - Rapide et précis" },
        { "value": "fade", "label": "6. Fade Focus - Focus avec fondu" },
        { "value": "mega", "label": "7. Mega Zoom - Zoom extrême" }
      ],
      "default": "smooth"
    },

    { "type": "header", "content": "═══ VITESSE DE TRANSITION ═══" },
    {
      "type": "range",
      "id": "transition_speed",
      "min": 0.2,
      "max": 2,
      "step": 0.1,
      "unit": "s",
      "label": "Vitesse de transition (secondes)",
      "default": 0.8
    },

    { "type": "header", "content": "═══ TAILLE CARTES DESKTOP ═══" },
    {
      "type": "range",
      "id": "card_width_desktop",
      "min": 500,
      "max": 900,
      "step": 10,
      "unit": "px",
      "label": "Largeur",
      "default": 650
    },
    {
      "type": "range",
      "id": "card_height_desktop",
      "min": 300,
      "max": 550,
      "step": 10,
      "unit": "px",
      "label": "Hauteur",
      "default": 380
    },

    { "type": "header", "content": "═══ TAILLE CARTES MOBILE ═══" },
    {
      "type": "range",
      "id": "card_width_mobile",
      "min": 260,
      "max": 380,
      "step": 5,
      "unit": "px",
      "label": "Largeur",
      "default": 300
    },
    {
      "type": "range",
      "id": "card_height_mobile",
      "min": 420,
      "max": 650,
      "step": 10,
      "unit": "px",
      "label": "Hauteur",
      "default": 500
    },

    { "type": "header", "content": "═══ BORDURES ═══" },
    {
      "type": "range",
      "id": "card_border_width",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Épaisseur bordure carte",
      "default": 1
    },

    { "type": "header", "content": "═══ FILTRES ═══" },
    { "type": "checkbox", "id": "show_concern_filter", "label": "Afficher filtres par problème", "default": true },
    { "type": "checkbox", "id": "show_language_filter", "label": "Afficher filtres par pays", "default": true },
    { "type": "color", "id": "filter_active_color", "label": "Couleur filtre actif", "default": "#27AE60" },

    { "type": "header", "content": "═══ TEXTES FILTRES PROBLÈME ═══" },
    { "type": "text", "id": "filter_concern_label", "label": "Label filtres problème", "default": "Filtrer par problématique" },
    { "type": "text", "id": "filter_all_icon", "label": "Icône Tous", "default": "✨" },
    { "type": "text", "id": "filter_all_text", "label": "Texte Tous", "default": "Tous les avis" },
    { "type": "text", "id": "filter_boutons_icon", "label": "Icône Boutons", "default": "🔴" },
    { "type": "text", "id": "filter_boutons_text", "label": "Texte Boutons", "default": "Boutons & Acné" },
    { "type": "text", "id": "filter_rides_icon", "label": "Icône Rides", "default": "✨" },
    { "type": "text", "id": "filter_rides_text", "label": "Texte Rides", "default": "Rides & Anti-âge" },
    { "type": "text", "id": "filter_rougeurs_icon", "label": "Icône Rougeurs", "default": "🌸" },
    { "type": "text", "id": "filter_rougeurs_text", "label": "Texte Rougeurs", "default": "Rougeurs & Sensibilité" },

    { "type": "header", "content": "═══ TEXTES FILTRES PAYS ═══" },
    { "type": "text", "id": "filter_lang_all_icon", "label": "Icône Tous pays", "default": "🌍" },
    { "type": "text", "id": "filter_lang_all_text", "label": "Texte Tous pays", "default": "Tous" },
    { "type": "text", "id": "filter_lang_fr_icon", "label": "Icône France", "default": "🇫🇷" },
    { "type": "text", "id": "filter_lang_fr_text", "label": "Texte France", "default": "France" },
    { "type": "text", "id": "filter_lang_ca_icon", "label": "Icône Canada", "default": "🇨🇦" },
    { "type": "text", "id": "filter_lang_ca_text", "label": "Texte Canada", "default": "Canada" },
    { "type": "text", "id": "filter_lang_be_icon", "label": "Icône Belgique", "default": "🇧🇪" },
    { "type": "text", "id": "filter_lang_be_text", "label": "Texte Belgique", "default": "Belgique" },

    { "type": "header", "content": "═══ BADGES DE CONFIANCE ═══" },
    { "type": "text", "id": "badge_1_icon", "label": "Icône Badge 1", "default": "🛡️" },
    { "type": "text", "id": "badge_1_text", "label": "Texte Badge 1", "default": "Avis vérifiés" },
    { "type": "text", "id": "badge_2_icon", "label": "Icône Badge 2", "default": "⏱️" },
    { "type": "text", "id": "badge_2_text", "label": "Texte Badge 2", "default": "Résultats 28j" },
    { "type": "text", "id": "badge_3_icon", "label": "Icône Badge 3", "default": "❤️" },
    { "type": "text", "id": "badge_3_text", "label": "Texte Badge 3", "default": "98% satisfaites" },

    { "type": "header", "content": "═══ BADGES PROBLÈME SUR CARTE ═══" },
    { "type": "text", "id": "badge_boutons_icon", "label": "Icône badge Boutons", "default": "🔴" },
    { "type": "text", "id": "badge_boutons_text", "label": "Texte badge Boutons", "default": "Acné" },
    { "type": "text", "id": "badge_rides_icon", "label": "Icône badge Rides", "default": "✨" },
    { "type": "text", "id": "badge_rides_text", "label": "Texte badge Rides", "default": "Anti-âge" },
    { "type": "text", "id": "badge_rougeurs_icon", "label": "Icône badge Rougeurs", "default": "🌸" },
    { "type": "text", "id": "badge_rougeurs_text", "label": "Texte badge Rougeurs", "default": "Rougeurs" },

    { "type": "header", "content": "═══ TAGS CLIENT ═══" },
    { "type": "text", "id": "tag_skin_type_icon", "label": "Icône type de peau", "default": "💧" },
    { "type": "text", "id": "tag_duration_icon", "label": "Icône durée", "default": "📅" },
    { "type": "text", "id": "tag_concern_icon", "label": "Icône problème", "default": "🎯" },
    { "type": "text", "id": "tag_boutons_text", "label": "Texte tag Boutons", "default": "Boutons" },
    { "type": "text", "id": "tag_rides_text", "label": "Texte tag Rides", "default": "Rides" },
    { "type": "text", "id": "tag_rougeurs_text", "label": "Texte tag Rougeurs", "default": "Rougeurs" },

    { "type": "header", "content": "═══ BARRE DE STATISTIQUES ═══" },
    { "type": "text", "id": "stat_1_number", "label": "Chiffre Stat 1", "default": "2,847+" },
    { "type": "text", "id": "stat_1_label", "label": "Label Stat 1", "default": "Clientes satisfaites" },
    { "type": "text", "id": "stat_2_number", "label": "Chiffre Stat 2", "default": "4.9/5" },
    { "type": "text", "id": "stat_2_label", "label": "Label Stat 2", "default": "Note moyenne" },
    { "type": "text", "id": "stat_3_number", "label": "Chiffre Stat 3", "default": "94%" },
    { "type": "text", "id": "stat_3_label", "label": "Label Stat 3", "default": "Résultats visibles" },

    { "type": "header", "content": "═══ TEXTES LABELS AVANT/APRÈS ═══" },
    { "type": "text", "id": "label_before_text", "label": "Texte label Avant", "default": "Avant" },
    { "type": "text", "id": "label_after_text", "label": "Texte label Après", "default": "Après" },

    { "type": "header", "content": "═══ TEXTES ROUTINE ═══" },
    { "type": "text", "id": "routine_title_text", "label": "Titre section routine", "default": "Ma routine" },
    { "type": "text", "id": "routine_icon", "label": "Icône routine", "default": "💆" },

    { "type": "header", "content": "═══ TEXTES DIVERS ═══" },
    { "type": "text", "id": "read_more_label", "label": "Label 'Voir plus'", "default": "Lire la suite..." },
    { "type": "text", "id": "read_less_label", "label": "Label 'Voir moins'", "default": "Réduire" },
    { "type": "text", "id": "no_results_text", "label": "Message aucun résultat", "default": "😔 Aucun avis ne correspond à ces critères. Essayez une autre combinaison." },
    { "type": "text", "id": "nav_prev_label", "label": "Label bouton précédent", "default": "Précédent" },
    { "type": "text", "id": "nav_next_label", "label": "Label bouton suivant", "default": "Suivant" },
    { "type": "text", "id": "cart_btn_label", "label": "Label bouton panier", "default": "Acheter" },
    { "type": "text", "id": "product_placeholder_title", "label": "Titre produit placeholder", "default": "Produit Exemple" },
    { "type": "text", "id": "product_placeholder_price", "label": "Prix produit placeholder", "default": "29.90€" },

    { "type": "header", "content": "═══ CONFIGURATION SLIDER ═══" },
    { "type": "checkbox", "id": "show_navigation", "label": "Afficher flèches", "default": true },
    { "type": "checkbox", "id": "show_pagination", "label": "Afficher points", "default": true },
    { "type": "checkbox", "id": "enable_active_card", "label": "Activer l'effet carte active", "default": true, "info": "Désactivez pour que toutes les cartes aient la même apparence" },
    { "type": "checkbox", "id": "enable_autoplay", "label": "Activer Autoplay", "default": false },
    { "type": "range", "id": "autoplay_delay", "min": 2, "max": 10, "label": "Délai Autoplay (s)", "default": 5 },

    { "type": "header", "content": "═══ ANIMATIONS ═══" },
    { "type": "checkbox", "id": "enable_animations", "label": "Activer les animations de contenu", "default": true },

    { "type": "header", "content": "═══ COULEURS PRINCIPALES ═══" },
    { "type": "color", "id": "bg_color", "label": "Fond section", "default": "#FDFBF9" },
    { "type": "color", "id": "card_bg_color", "label": "Fond carte", "default": "#FFFFFF" },
    { "type": "color", "id": "card_border_color", "label": "Bordure carte", "default": "#000000" },
    { "type": "color", "id": "card_active_border_color", "label": "Bordure carte active", "default": "#000000" },
    { "type": "color", "id": "title_color", "label": "Titres section", "default": "#1a1a1a" },
    { "type": "color", "id": "text_color", "label": "Textes section", "default": "#555555" },

    { "type": "header", "content": "═══ COULEURS LABELS AVANT/APRÈS ═══" },
    { "type": "color", "id": "label_bg_color", "label": "Fond labels", "default": "#ffffff" },
    { "type": "color", "id": "label_text_color", "label": "Texte labels", "default": "#333333" },

    { "type": "header", "content": "═══ COULEURS BADGES ═══" },
    { "type": "color", "id": "concern_badge_bg_color", "label": "Fond badge problème", "default": "#ffffff" },
    { "type": "color", "id": "concern_badge_text_color", "label": "Texte badge problème", "default": "#27AE60" },
    { "type": "color", "id": "language_badge_bg_color", "label": "Fond badge pays", "default": "#ffffff" },
    { "type": "color", "id": "language_badge_text_color", "label": "Texte badge pays", "default": "#555555" },

    { "type": "header", "content": "═══ COULEURS TAGS CLIENT ═══" },
    { "type": "color", "id": "client_tag_bg_color", "label": "Fond tags client", "default": "#f5f5f5" },
    { "type": "color", "id": "client_tag_text_color", "label": "Texte tags client", "default": "#555555" },

    { "type": "header", "content": "═══ COULEURS ROUTINE ═══" },
    { "type": "color", "id": "routine_bg_color", "label": "Fond section routine", "default": "#f0fdf4" },
    { "type": "color", "id": "routine_border_color", "label": "Bordure routine", "default": "#27AE60" },
    { "type": "color", "id": "routine_title_color", "label": "Titre routine", "default": "#27AE60" },
    { "type": "color", "id": "routine_text_color", "label": "Texte routine", "default": "#555555" },

    { "type": "header", "content": "═══ COULEURS CONTENU CARTE ═══" },
    { "type": "color", "id": "author_name_color", "label": "Nom auteur", "default": "#1a1a1a" },
    { "type": "color", "id": "author_age_color", "label": "Âge auteur", "default": "#555555" },
    { "type": "color", "id": "review_title_color", "label": "Titre avis", "default": "#1a1a1a" },
    { "type": "color", "id": "review_text_color", "label": "Texte avis", "default": "#555555" },
    { "type": "color", "id": "read_more_color", "label": "Lien voir plus", "default": "#1a1a1a" },
    { "type": "color", "id": "rating_number_color", "label": "Note chiffrée", "default": "#1a1a1a" },

    { "type": "header", "content": "═══ COULEURS PRODUIT ═══" },
    { "type": "color", "id": "product_bg_color", "label": "Fond bloc produit", "default": "#F9F9F9" },
    { "type": "color", "id": "product_title_color", "label": "Titre produit", "default": "#1a1a1a" },
    { "type": "color", "id": "product_subtitle_color", "label": "Prix produit", "default": "#555555" },

    { "type": "header", "content": "═══ COULEURS ÉTOILES ═══" },
    { "type": "color", "id": "verified_icon_color", "label": "Icône vérifié", "default": "#27AE60" },
    { "type": "color", "id": "star_color", "label": "Étoiles Trustpilot", "default": "#00B67A" },

    { "type": "header", "content": "═══ COULEURS NAVIGATION ═══" },
    { "type": "color", "id": "arrow_color", "label": "Couleur flèches", "default": "#1a1a1a" },
    { "type": "color", "id": "dot_color", "label": "Points inactifs", "default": "#cccccc" },
    { "type": "color", "id": "dot_active_color", "label": "Point actif", "default": "#1a1a1a" },

    { "type": "header", "content": "═══ COULEURS CTA ═══" },
    { "type": "color", "id": "cta_bg_color", "label": "Fond bouton CTA", "default": "#1a1a1a" },
    { "type": "color", "id": "cta_text_color", "label": "Texte bouton CTA", "default": "#ffffff" },

    { "type": "header", "content": "═══ MISE EN PAGE ═══" },
    { "type": "range", "id": "padding_top", "label": "Marge haut", "min": 0, "max": 100, "default": 60 },
    { "type": "range", "id": "padding_bottom", "label": "Marge bas", "min": 0, "max": 100, "default": 60 },
    { "type": "select", "id": "layout_width", "label": "Largeur", "options": [ { "value": "container", "label": "Conteneur" }, { "value": "full", "label": "Pleine largeur" } ], "default": "container" }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Avis Client",
      "settings": [
        { "type": "header", "content": "🌍 Langue & Pays" },
        { "type": "select", "id": "review_language", "label": "Pays", "options": [
          { "value": "fr", "label": "France 🇫🇷" },
          { "value": "ca", "label": "Canada 🇨🇦" },
          { "value": "be", "label": "Belgique 🇧🇪" },
          { "value": "ch", "label": "Suisse 🇨🇭" }
        ], "default": "fr" },
        { "type": "checkbox", "id": "show_country_flag", "label": "Afficher drapeau", "default": true },
        { "type": "checkbox", "id": "show_language_code", "label": "Afficher code pays", "default": false },
        { "type": "text", "id": "country_flag", "label": "Emoji drapeau", "default": "🇫🇷" },

        { "type": "header", "content": "🎯 Problématique de peau" },
        { "type": "select", "id": "skin_concern", "label": "Problème principal", "options": [
          { "value": "none", "label": "Non spécifié" },
          { "value": "boutons", "label": "🔴 Boutons & Acné" },
          { "value": "rides", "label": "✨ Rides & Anti-âge" },
          { "value": "rougeurs", "label": "🌸 Rougeurs & Sensibilité" }
        ], "default": "none" },

        { "type": "header", "content": "📸 Images" },
        { "type": "checkbox", "id": "use_single_image", "label": "Image unique (pas avant/après)", "default": false },
        { "type": "image_picker", "id": "image_combined", "label": "Image unique" },
        { "type": "image_picker", "id": "image_before", "label": "Image Avant" },
        { "type": "image_picker", "id": "image_after", "label": "Image Après" },

        { "type": "header", "content": "📅 Labels Jours (optionnel)" },
        { "type": "text", "id": "label_before_custom", "label": "Label personnalisé Avant", "info": "Ex: Jour 1, Semaine 1... Laissez vide pour utiliser le label par défaut" },
        { "type": "text", "id": "label_after_custom", "label": "Label personnalisé Après", "info": "Ex: Jour 30, Semaine 4... Laissez vide pour utiliser le label par défaut" },

        { "type": "header", "content": "👤 Profil Client" },
        { "type": "text", "id": "author_name", "label": "Prénom", "default": "Sophie M." },
        { "type": "text", "id": "author_age", "label": "Âge", "default": "42 ans" },
        { "type": "select", "id": "skin_type", "label": "Type de peau", "options": [
          { "value": "", "label": "Non spécifié" },
          { "value": "Peau sèche", "label": "Peau sèche" },
          { "value": "Peau grasse", "label": "Peau grasse" },
          { "value": "Peau mixte", "label": "Peau mixte" },
          { "value": "Peau sensible", "label": "Peau sensible" },
          { "value": "Peau mature", "label": "Peau mature" },
          { "value": "Peau acnéique", "label": "Peau acnéique" }
        ], "default": "" },
        { "type": "text", "id": "usage_duration", "label": "Durée d'utilisation", "default": "3 mois", "info": "Ex: 2 semaines, 1 mois, 3 mois..." },
        { "type": "range", "id": "rating", "min": 0, "max": 5, "step": 0.1, "label": "Note (sur 5)", "default": 5, "info": "Sélectionnez une note de 0.0 à 5.0 (ex: 4.3/5, 4.7/5, etc.)" },

        { "type": "header", "content": "💬 Contenu de l'avis" },
        { "type": "text", "id": "review_title", "label": "Titre accrocheur", "default": "Ma peau a changé de vie !" },
        { "type": "textarea", "id": "review_text", "label": "Témoignage détaillé", "default": "Après des années à chercher LE produit miracle, j'ai enfin trouvé ce qui fonctionne pour moi. Dès les premières semaines, j'ai vu une vraie différence sur mes imperfections. Ma peau est plus lisse, plus éclatante. Je recommande à 100% !" },
        { "type": "textarea", "id": "routine_text", "label": "Routine utilisée (optionnel)", "default": "Matin : nettoyant doux + sérum + crème hydratante. Soir : double nettoyage + sérum + huile de nuit.", "info": "Décrivez la routine quotidienne de la cliente" },

        { "type": "header", "content": "🛍️ Produit" },
        { "type": "product", "id": "product", "label": "Produit acheté" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Avis Clients Premium 3D",
      "blocks": [
        {
          "type": "testimonial",
          "settings": {
            "review_language": "fr",
            "country_flag": "🇫🇷",
            "skin_concern": "boutons",
            "author_name": "Émilie R.",
            "author_age": "28 ans",
            "skin_type": "Peau mixte",
            "usage_duration": "2 mois",
            "rating": 4.8,
            "review_title": "Enfin une peau nette !",
            "review_text": "J'avais des boutons depuis l'adolescence et rien ne fonctionnait. J'ai essayé tellement de produits... Avec cette routine, en 2 mois mes boutons ont quasiment disparu. Ma peau est plus lisse, plus uniforme. Je n'ose plus sortir sans maquillage avant, maintenant je me sens belle au naturel. Mes collègues m'ont même demandé ce que j'avais changé !",
            "routine_text": "Matin : nettoyant moussant + sérum anti-imperfections + crème légère SPF30. Soir : huile démaquillante + gel nettoyant + sérum + crème réparatrice.",
            "label_before_custom": "Jour 1",
            "label_after_custom": "Jour 60"
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "review_language": "fr",
            "country_flag": "🇫🇷",
            "skin_concern": "rides",
            "author_name": "Catherine D.",
            "author_age": "54 ans",
            "skin_type": "Peau mature",
            "usage_duration": "4 mois",
            "rating": 5,
            "review_title": "10 ans de moins sur mon visage",
            "review_text": "À 54 ans, j'avais accepté mes rides comme une fatalité. Mon mari m'a offert ce coffret pour notre anniversaire. Après 4 mois d'utilisation, le résultat est bluffant : mes rides du front sont estompées, mes pattes d'oie moins visibles, et surtout mon teint est lumineux ! Mes amies pensent que j'ai fait des injections. Je leur dis que non, c'est juste une bonne routine !",
            "routine_text": "Matin : eau micellaire + sérum vitamine C + crème anti-âge + contour yeux. Soir : double nettoyage + sérum rétinol (2x/semaine) + crème de nuit riche + huile précieuse.",
            "label_before_custom": "Semaine 1",
            "label_after_custom": "Semaine 16"
          }
        },
         {
          "type": "testimonial",
          "settings": {
            "review_language": "ca",
            "country_flag": "🇨🇦",
            "skin_concern": "rougeurs",
            "author_name": "Marie-Josée L.",
            "author_age": "35 ans",
            "skin_type": "Peau sensible",
            "usage_duration": "6 semaines",
            "rating": 4.5,
            "review_title": "Adieu les rougeurs !",
            "review_text": "Vivant à Montréal, le froid aggravait terriblement mes rougeurs et ma rosacée. J'avais honte de sortir sans fond de teint épais. Depuis que j'utilise ces produits, ma peau tolère beaucoup mieux les changements de température. Les rougeurs ont diminué de moitié en 6 semaines. Je peux enfin me maquiller légèrement ! Merci du fond du cœur 🍁",
            "routine_text": "Matin : eau thermale + sérum apaisant + crème anti-rougeurs + protection solaire minérale. Soir : lait nettoyant ultra-doux + sérum réparateur + baume SOS zones irritées.",
            "label_before_custom": "Jour 1",
            "label_after_custom": "Jour 42"
          }
        }
      ]
    }
  ]
}
{% endschema %}