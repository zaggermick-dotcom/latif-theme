{% include 'shogun-content-handler' %}
<!doctype html>
<html class="no-js" lang="{{ request.locale.iso_code }}">
  <head>
<meta name="google-site-verification" content="tY5FH8RoQM6RoL1dsudC-PBDx3AhyaZiLka6hSDJe1Q" />
<meta name="google-site-verification" content="igItrlCXCJNU6mFjittLz3E25IvTjM1Nmy1ndbyEwpY" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="">
    <meta name="shop-url" content="{{ shop.domain }}">
    <link rel="canonical" href="{{ canonical_url }}">
    <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>

    {%- if settings.favicon != blank -%}
      <link rel="icon" type="image/png" href="{{ settings.favicon | image_url: width: 32, height: 32 }}">
    {%- endif -%}

    {%- unless settings.headings_font.system? and settings.body_font.system? -%}
      <link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>
    {%- endunless -%}

    <title>
      {{ page_title }}
      {%- if current_tags %}
        &ndash; tagged "{{ current_tags | join: ', ' }}"
      {%- endif -%}
      {%- if current_page != 1 %}
        &ndash; Page {{ current_page -}}
      {%- endif -%}
      {%- unless page_title contains shop.name %}
        &ndash; {{ shop.name -}}
      {%- endunless -%}
    </title>

    {% if page_description %}
      <meta name="description" content="{{ page_description | escape }}">
    {% endif %}

    {% render 'meta-tags' %}
    {%- render 'script' with 'manual-stock-urgency', defer: true -%}

    {%- render 'script' with 'constants', defer: true -%}
    {%- render 'script' with 'pubsub', defer: true -%}
    <script src="https://www.story-theme.com/modal-master.js"></script>
    <script src="https://api.story-theme.com/sliders.js"></script>
    {%- render 'script' with 'global', defer: true -%}
    <script src="{{ 'swiper.js' | asset_url }}"></script>
    {%- if settings.enable_wishlist -%}
      {%- render 'script' with 'wishlist', defer: true -%}
    {%- endif -%}
    {%- if settings.cart_type == "drawer" -%}
      {%- render 'script' with 'cart', defer: true -%}
      {%- render 'script' with 'cart-drawer', defer: true -%}
    {%- elsif settings.cart_type == "notification" -%}
      {%- render 'script' with 'cart', defer: true -%}
      {%- render 'script' with 'cart-notification', defer: true -%}
    {%- endif -%}

    {{ content_for_header }}

    {%- render 'css-variables' -%}
    {%- if settings.enable_animations -%}
      {{ 'animations.css' | asset_url | stylesheet_tag }}
    {%- endif -%}
    {{ 'base.css' | asset_url | stylesheet_tag }}
    {{ 'swiper.css' | asset_url | stylesheet_tag }}
    {%- if settings.enable_wishlist -%}
      {{ 'wishlist.css' | asset_url | stylesheet_tag }}
    {%- endif -%}

    <link rel="stylesheet" href="{{ 'component-cart-items.css' | asset_url }}" media="print" onload="this.media='all'">
    {%- if settings.cart_type == "drawer" -%}
      {{ 'component-cart-drawer.css' | asset_url | stylesheet_tag }}
      {{ 'component-cart.css' | asset_url | stylesheet_tag }}
      {{ 'component-totals.css' | asset_url | stylesheet_tag }}
      {{ 'component-price.css' | asset_url | stylesheet_tag }}
      {{ 'component-discounts.css' | asset_url | stylesheet_tag }}
      {{ 'component-loading-overlay.css' | asset_url | stylesheet_tag }}
    {%- elsif settings.cart_type == "notification" -%}
      {{ 'component-cart-notification.css' | asset_url | stylesheet_tag }}
      {{ 'component-cart.css' | asset_url | stylesheet_tag }}
      {{ 'component-totals.css' | asset_url | stylesheet_tag }}
      {{ 'component-price.css' | asset_url | stylesheet_tag }}
    {%- endif -%}

    {%- unless settings.body_font.system? -%}
      <link rel="preload" as="font" href="{{ settings.body_font | font_url }}" type="font/woff2" crossorigin>
    {%- endunless -%}
    {%- unless settings.headings_font.system? -%}
      <link rel="preload" as="font" href="{{ settings.headings_font | font_url }}" type="font/woff2" crossorigin>
    {%- endunless -%}

    {%- if settings.predictive_search_enabled -%}
      <link rel="stylesheet" href="{{ 'component-predictive-search.css' | asset_url }}" media="print" onload="this.media='all'">
    {%- endif -%}

    {%- render 'animations' -%}
    <script>
      document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
      if (Shopify.designMode) {
        document.documentElement.classList.add('shopify-design-mode');
      }
    </script>

    {%- comment -%}
      Styles spécifiques pour la page panier :
      - page pleine, fond opaque
      - bloc code promo / sous-total / total / checkout en bas
      - footer caché sur la page panier
      - blocage du scroll de l'arrière-plan quand un drawer est ouvert
    {%- endcomment -%}
    <style>
      /* S'assurer que le viewport occupe toute la hauteur */
      html, body {
        height: 100%;
      }

      /* Page panier : fond blanc plein, stable sur tout l'écran */
      .template-cart {
        background: #ffffff;
      }

      .template-cart .page-wrapper {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .template-cart #MainContent {
        flex: 1 0 auto;
      }

      /* Mettre le bloc totals (code promo, sous-total, total, checkout) tout en bas de la page panier */
      .template-cart .cart__contents,
      .template-cart .cart__items-wrapper,
      .template-cart form.cart__contents {
        display: flex !important;
        flex-direction: column !important;
        min-height: 100vh !important;
      }

      .template-cart .cart__footer,
      .template-cart .cart__footer-wrapper,
      .template-cart .totals,
      .template-cart .cart__blocks {
        margin-top: auto !important;
      }

      .template-cart .cart__items {
        flex-grow: 1 !important;
      }

      .template-cart .cart__footer {
        padding-bottom: 20px !important;
      }

      /* Cacher le footer sur la page panier (aucun bas de page qui défile derrière) */
      .template-cart footer,
      .template-cart .shopify-section-group-footer-group {
        display: none !important;
      }

      /* Bloquer le scroll de l'arrière-plan quand un drawer / panier slide est ouvert (Safari/iPhone) */
      .js-drawer-open,
      .js-drawer-open body,
      .cart-drawer-open,
      .cart-drawer-open body {
        overflow: hidden !important;
        height: 100% !important;
      }
    </style>
  
  {% render 'shogun-head' %}
</head>

  <body
    data-shop-locale="{{ shop.locale }}"
    data-shop-currency="{{ cart.currency.iso_code }}"
    {% if settings.domain_name != blank %}
      data-domain="{{ settings.domain_name | remove: 'https://' | remove: 'www.' | remove: '/' | downcase }}"
    {% endif %}
    {%- if settings.disable_right_click %}
      oncontextmenu="return false;"
    {% endif -%}
  >
    {% if settings.enable_page_transitions %}
      {%- render 'fade-page-transitions' -%}
    {% endif %}

    <a class="skip-to-content-link button visually-hidden" href="#MainContent">
      {{ 'accessibility.skip_to_text' | t }}
    </a>

    {%- liquid
echo "<div style='display:none'>"       sections 'header-group' echo "</div>"

      if settings.cart_type == 'drawer' and request.page_type != 'cart'
        section 'cart-drawer'
      endif

      if settings.cart_type == 'notification' and request.page_type != 'cart'
        render 'cart-notification'
      endif

      if template contains 'product'
        section 'main-sticky-atc'
      endif
    -%}

    <div class="overlay hidden"></div>
    <div class="modal content-container hidden"></div>
    
    <div class="page-wrapper">
      <main
        id="MainContent"
        class="content-for-layout focus-none"
        role="main"
        tabindex="-1"
      >
        {{ content_for_layout }}
      </main>

      {%- unless request.page_type == 'cart' -%}
        {% sections 'footer-group' %}
      {%- endunless -%}

      <ul hidden>
        <li id="a11y-refresh-page-message">
          {{ 'accessibility.refresh_page' | t }}
        </li>
        <li id="a11y-new-window-message">
          {{ 'accessibility.link_messages.new_window' | t }}
        </li>
      </ul>

      <script>
        window.theme = { 
          version: Shopify.theme.schema_version
        };
        window.shopUrl = '{{ request.origin }}';
        window.routes = {
          cart_add_url: '{{ routes.cart_add_url }}',
          cart_change_url: '{{ routes.cart_change_url }}',
          cart_update_url: '{{ routes.cart_update_url }}',
          cart_url: '{{ routes.cart_url }}',
          predictive_search_url: '{{ routes.predictive_search_url }}',
        };

        window.productForm = {
          error: '{{ 'general.product_form.error' | t }}'
        }

        window.timer = {
          type: "{{ settings.timer_type }}",
          days: "{{ settings.timer_days }}",
          hours: "{{ settings.timer_hours }}",
          minutes: "{{ settings.timer_minutes }}",
          seconds: "{{ settings.timer_seconds }}",
          link: "{{ settings.timer_redirect_link }}",
          day: "{{ settings.timer_day }}",
          month: "{{ settings.timer_month }}",
          year: "{{ settings.timer_year }}",
        }

        window.cartStrings = {
          error: `{{ 'sections.cart.cart_error' | t }}`,
          quantityError: `{{ 'sections.cart.cart_quantity_error_html' | t: quantity: '[quantity]' }}`,
        };

        window.variantStrings = {
          addToCart: `{{ 'products.product.add_to_cart' | t }}`,
          soldOut: `{{ 'products.product.sold_out' | t }}`,
          unavailable: `{{ 'products.product.unavailable' | t }}`,
          unavailable_with_option: `{{ 'products.product.value_unavailable' | t: option_value: '[value]' }}`,
        };

        window.accessibilityStrings = {
          imageAvailable: `{{ 'products.product.media.image_available' | t: index: '[index]' }}`,
          shareSuccess: `{{ 'general.share.success_message' | t }}`,
          pauseSlideshow: `{{ 'sections.slideshow.pause_slideshow' | t }}`,
          playSlideshow: `{{ 'sections.slideshow.play_slideshow' | t }}`,
        };
      </script>

      {%- if settings.enable_animations -%}
        {%- render 'script' with 'animations' -%}
        <script>
          AOS.init();
        </script>
      {%- endif -%}
    </div>

  </body>
</html>